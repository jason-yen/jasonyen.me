<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>jasonyen.me</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    padding-top: 56px;
    font-family: Arial, sans-serif;
    background-color: #f5f6fa;
}

/* ================= NAVBAR ================= */
.navbar {
    width: 100%;
    height: 56px;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 9999;
    display: flex;
    align-items: center;
    padding: 0 40px;
    gap: 20px;
    background: rgba(200, 200, 255, 0.093);
    backdrop-filter: blur(15px);
    border-bottom: 1px solid rgba(200, 200, 255, 0.2);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
}

.navbar-content {
    display: flex;
    align-items: center;
    gap: 20px;
}

.navbar img {
    width: 40px;
    height: 40px;
    border-radius: 12px;
}

.navbar a {
    color: #536DFE;
    font-weight: 500;
    text-decoration: none;
}

.separator { color: #9dacff; font-size: 20px; }

/* ================= TITLE ================= */
.main-title {
    font-size: 42px;
    font-weight: bold;
    margin: 40px 40px 20px 40px;
}

/* ================= GAME AREA ================= */
.game-container {
    margin: 20px 40px 40px 40px;
}

canvas {
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    display: block;
}

/* ================= BUTTON ================= */
.game-link {
    display: inline-block;
    padding: 12px 25px;
    background-color: #4c5eaf;
    color: white;
    font-size: 18px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: 0.3s ease;
    margin-top: 15px;
}

.game-link:hover {
    background-color: #2f4a88;
    transform: translateY(-3px);
}

.score {
    font-size: 20px;
    margin-bottom: 15px;
}
</style>
</head>

<body>

<div class="navbar">
    <div class="navbar-content">
        <a href="/"><img src="/images/WardenmonsterLogo.PNG"></a>
        <a href="/games">Games</a>
        <div class="separator">|</div>
        <a href="/tools">Tools</a>
        <div class="separator">|</div>
        <a href="/donatejk">Donate</a>
        <div class="separator">|</div>
        <a href="/ai">Search</a>
        <div class="separator">|</div>
        <a href="/noises">Sounds</a>
    </div>
</div>

<div class="main-title">Falling Game</div>

<div class="game-container">
    <div class="score">Score: <span id="score">0</span></div>
    <canvas id="gameCanvas" width="700" height="400"></canvas>
    <br>
    <button class="game-link" onclick="restartGame()">Restart Game</button>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

/* ================= IMAGES ================= */
const playerImg = new Image();
playerImg.src = "https://www.pngmart.com/files/23/Blob-PNG-Free-Download.png";

const enemyImg = new Image();
enemyImg.src = "https://upload.wikimedia.org/wikipedia/en/thumb/e/eb/Enemy_logo.svg/500px-Enemy_logo.svg.png";

/* ================= GAME STATE ================= */
let player = { x: 325, y: 350, width: 50, height: 50, velocity: 0 };
let bullets = [];
let enemies = [];
let keys = {};
let score = 0;
let gameOver = false;
let shootCooldown = 0;
let enemySpeed = 3;
let spawnCount = 2; // start with 2 enemies per interval

/* ================= CONTROLS ================= */
document.addEventListener("keydown", e => {
    keys[e.key] = true;
    if (["ArrowLeft","ArrowRight"," "].includes(e.key)) e.preventDefault();
});
document.addEventListener("keyup", e => keys[e.key] = false);

/* ================= DRAW ================= */
function drawPlayer() {
    ctx.drawImage(playerImg, player.x, player.y, player.width, player.height);
}
function drawBullets() {
    ctx.fillStyle = "red";
    bullets.forEach(b => ctx.fillRect(b.x, b.y, 5, 10));
}
function drawEnemies() {
    enemies.forEach(e => ctx.drawImage(enemyImg, e.x, e.y, e.width, e.height));
}

/* ================= UPDATE ================= */
function updatePlayer() {
    const acceleration = 0.6;
    const friction = 0.85;
    const maxSpeed = 7;

    if (keys["ArrowLeft"]) player.velocity -= acceleration;
    if (keys["ArrowRight"]) player.velocity += acceleration;

    player.velocity *= friction;

    if (player.velocity > maxSpeed) player.velocity = maxSpeed;
    if (player.velocity < -maxSpeed) player.velocity = -maxSpeed;

    player.x += player.velocity;
    if (player.x < 0) player.x = 0;
    if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;

    // Shooting
    if (keys[" "] && shootCooldown <= 0) {
        bullets.push({ x: player.x + player.width/2 - 2, y: player.y });
        shootCooldown = 12;
    }
    if (shootCooldown > 0) shootCooldown--;
}

function updateBullets() {
    bullets.forEach(b => b.y -= 6);
    bullets = bullets.filter(b => b.y > 0);
}

function updateEnemies() {
    enemies.forEach(e => e.y += enemySpeed);

    enemies.forEach(e => {
        if (e.y + e.height > player.y &&
            e.x < player.x + player.width &&
            e.x + e.width > player.x) gameOver = true;
    });

    enemies = enemies.filter(e => e.y < canvas.height);
}

function detectCollisions() {
    for (let i = bullets.length - 1; i >= 0; i--) {
        for (let j = enemies.length - 1; j >= 0; j--) {
            if (
                bullets[i].x < enemies[j].x + enemies[j].width &&
                bullets[i].x + 5 > enemies[j].x &&
                bullets[i].y < enemies[j].y + enemies[j].height &&
                bullets[i].y + 10 > enemies[j].y
            ) {
                bullets.splice(i,1);
                enemies.splice(j,1);
                break;
            }
        }
    }
}

/* ================= SPAWN ================= */
function spawnEnemy() {
    const x = Math.random() * (canvas.width - 50);
    enemies.push({ x: x, y: 0, width: 50, height: 50 });
}

/* ================= GAME LOOP ================= */
function gameLoop() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    if (gameOver) {
        ctx.fillStyle = "red";
        ctx.font = "40px Arial";
        ctx.fillText("Game Over", 230, 200);
        return;
    }

    updatePlayer();
    updateBullets();
    updateEnemies();
    detectCollisions();

    drawPlayer();
    drawBullets();
    drawEnemies();

    requestAnimationFrame(gameLoop);
}

/* ================= SCORE INCREMENT ================= */
setInterval(() => {
    if (!gameOver) {
        score++;
        document.getElementById("score").textContent = score;
    }
}, 1000);

/* ================= SPAWN INTERVAL & DIFFICULTY ================= */
setInterval(() => {
    if (!gameOver) {
        for (let i = 0; i < Math.floor(spawnCount); i++) spawnEnemy();
        // Increase difficulty gradually
        if (enemySpeed < 10) enemySpeed += 0.03;      // faster enemies
        if (spawnCount < 6) spawnCount += 0.01;       // more enemies per interval
    }
}, 800);

/* ================= RESTART ================= */
function restartGame() {
    bullets = [];
    enemies = [];
    score = 0;
    gameOver = false;
    player.x = 325;
    player.velocity = 0;
    enemySpeed = 3;
    spawnCount = 2;
    document.getElementById("score").textContent = score;
    gameLoop();
}

gameLoop();
</script>

</body>
</html>
